<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Private Tweeter</title>
    <style>
        body { font-family: sans-serif; max-width: 500px; margin: 50px auto; padding: 20px; background: #f5f8fa; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        textarea { width: 100%; height: 100px; border: 1px solid #ccd6dd; border-radius: 10px; padding: 10px; box-sizing: border-box; resize: none; }
        button { background: #1da1f2; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: bold; margin-top: 10px; }
        button:hover { background: #1a91da; }
        .settings { margin-top: 30px; font-size: 0.8em; color: #657786; border-top: 1px solid #eee; pt: 10px; }
        input { width: 100%; margin-bottom: 5px; padding: 5px; border: 1px solid #ccc; border-radius: 4px; }
    </style>
</head>
<body>

<div class="card">
    <h2>ã„ã¾ã©ã†ã—ã¦ã‚‹ï¼Ÿ</h2>
    <textarea id="tweetText" placeholder="ã“ã“ã«å…¥åŠ›..."></textarea>
    <button onclick="postTweet()">ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹</button>
    <p id="status"></p>

    <div class="settings">
        <h3>ğŸ”‘ APIã‚­ãƒ¼è¨­å®š (ãƒ–ãƒ©ã‚¦ã‚¶ã«ã®ã¿ä¿å­˜ã•ã‚Œã¾ã™)</h3>
        <input type="password" id="apiKey" placeholder="API Key">
        <input type="password" id="apiSecret" placeholder="API Key Secret">
        <input type="password" id="accessToken" placeholder="Access Token">
        <input type="password" id="accessTokenSecret" placeholder="Access Token Secret">
        <button onclick="saveKeys()" style="background: #657786;">ã‚­ãƒ¼ã‚’ä¿å­˜</button>
    </div>
</div>

<script>
    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«LocalStorageã‹ã‚‰ã‚­ãƒ¼ã‚’å¾©å…ƒ
    window.onload = () => {
        document.getElementById('apiKey').value = localStorage.getItem('x_api_key') || '';
        document.getElementById('apiSecret').value = localStorage.getItem('x_api_secret') || '';
        document.getElementById('accessToken').value = localStorage.getItem('x_access_token') || '';
        document.getElementById('accessTokenSecret').value = localStorage.getItem('x_access_token_secret') || '';
    };

    function saveKeys() {
        localStorage.setItem('x_api_key', document.getElementById('apiKey').value);
        localStorage.setItem('x_api_secret', document.getElementById('apiSecret').value);
        localStorage.setItem('x_access_token', document.getElementById('accessToken').value);
        localStorage.setItem('x_access_token_secret', document.getElementById('accessTokenSecret').value);
        alert('ã‚­ãƒ¼ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ã—ã¾ã—ãŸã€‚');
    }

    async function postTweet() {
        const text = document.getElementById('tweetText').value;
        const status = document.getElementById('status');
        
        if (!text) return alert('å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');

        status.innerText = 'é€ä¿¡ä¸­...';

        // â€» X API v2 ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹
        // ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ç›´æ¥é€ã‚‹å ´åˆã€OAuth 1.0aã®ç½²åè¨ˆç®—ãŒå¿…è¦ã§ã™ã€‚
        // ã“ã“ã§ã¯æ¦‚å¿µçš„ãªFetchã‚’ç¤ºã—ã¾ã™ï¼ˆå®Ÿéš›ã«ã¯ç½²åãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¿…è¦ã§ã™ï¼‰
        
        try {
            // æ³¨æ„: å®Ÿéš›ã«ã¯ã“ã“ã«OAuthç½²åä½œæˆãƒ­ã‚¸ãƒƒã‚¯ãŒå…¥ã‚Šã¾ã™
            // è‡ªåˆ†å°‚ç”¨ãªã‚‰ã€CORSå›é¿ç”¨ã®ãƒ—ãƒ­ã‚­ã‚·URLã‚’å…ˆé ­ã«ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
            const proxyUrl = "https://your-proxy.com/"; 
            const apiUrl = "https://api.twitter.com/2/tweets";

            const response = await fetch(proxyUrl + apiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    // 'Authorization': `OAuth ...ç½²åãƒ‡ãƒ¼ã‚¿...`
                },
                body: JSON.stringify({ text: text })
            });

            if (response.ok) {
                status.innerText = 'âœ… æŠ•ç¨¿æˆåŠŸï¼';
                document.getElementById('tweetText').value = '';
            } else {
                status.innerText = 'âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ';
            }
        } catch (e) {
            status.innerText = 'âŒ é€ä¿¡å¤±æ•—: ' + e.message;
        }
    }
</script>

</body>
</html>
