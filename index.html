<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Private Tweeter</title>
    <style>
        body { font-family: sans-serif; max-width: 500px; margin: 50px auto; padding: 20px; background: #f5f8fa; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        textarea { width: 100%; height: 100px; border: 1px solid #ccd6dd; border-radius: 10px; padding: 10px; box-sizing: border-box; resize: none; margin-bottom: 10px; }
        button { background: #1da1f2; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: bold; }
        button:hover { background: #1a91da; }
        .settings { margin-top: 30px; font-size: 0.8em; color: #657786; border-top: 1px solid #eee; padding-top: 10px; }
        .settings h3 { margin-bottom: 10px; }
        .input-group { margin-bottom: 10px; }
        label { display: block; margin-bottom: 2px; font-weight: bold; }
        input { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
    </style>
</head>
<body>

<div class="card">
    <h2>ã„ã¾ã©ã†ã—ã¦ã‚‹ï¼Ÿ</h2>
    <textarea id="tweetText" placeholder="ã“ã“ã«å…¥åŠ›..."></textarea>
    <button onclick="postTweet()">ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹</button>
    <p id="status"></p>

    <div class="settings">
        <h3>ğŸ”‘ APIè¨­å®šï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ï¼‰</h3>
        
        <div class="input-group">
            <label>API Key / Consumer Key</label>
            <input type="password" id="consumerKey">
        </div>

        <div class="input-group">
            <label>API Key Secret / Consumer Secret</label>
            <input type="password" id="consumerSecret">
        </div>

        <div class="input-group">
            <label>Access Token</label>
            <input type="password" id="accessToken">
        </div>

        <div class="input-group">
            <label>Access Token Secret</label>
            <input type="password" id="accessTokenSecret">
        </div>

        <button onclick="saveKeys()" style="background: #657786;">è¨­å®šã‚’ä¿å­˜</button>
    </div>
</div>

<script>
    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ä¿å­˜ã•ã‚ŒãŸå€¤ã‚’å¾©å…ƒ
    window.onload = () => {
        document.getElementById('consumerKey').value = localStorage.getItem('x_consumer_key') || '';
        document.getElementById('consumerSecret').value = localStorage.getItem('x_consumer_secret') || '';
        document.getElementById('accessToken').value = localStorage.getItem('x_access_token') || '';
        document.getElementById('accessTokenSecret').value = localStorage.getItem('x_access_token_secret') || '';
    };

    function saveKeys() {
        localStorage.setItem('x_consumer_key', document.getElementById('consumerKey').value);
        localStorage.setItem('x_consumer_secret', document.getElementById('consumerSecret').value);
        localStorage.setItem('x_access_token', document.getElementById('accessToken').value);
        localStorage.setItem('x_access_token_secret', document.getElementById('accessTokenSecret').value);
        alert('è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚');
    }

    async function postTweet() {
        const text = document.getElementById('tweetText').value;
        const status = document.getElementById('status');
        
        if (!text) return alert('å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');

        status.innerText = 'é€ä¿¡ä¸­...';

        try {
            // æ³¨æ„: ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ç›´æ¥é€ä¿¡ã™ã‚‹å ´åˆã€CORSãƒ—ãƒ­ã‚­ã‚·ã¾ãŸã¯æ‹¡å¼µæ©Ÿèƒ½ãŒå¿…è¦ã§ã™
            const proxyUrl = ""; // ä¾‹: "https://cors-anywhere.herokuapp.com/"
            const apiUrl = "https://api.twitter.com/2/tweets";

            // â€»å®Ÿéš›ã«ã¯ã“ã“ã§OAuthç½²åã®ä½œæˆãŒå¿…è¦ã§ã™ãŒã€
            // ã¾ãšã¯è¨­å®šãŒæ­£ã—ãä¿å­˜ãƒ»èª­ã¿è¾¼ã¿ã§ãã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
            console.log("ä½¿ç”¨ã™ã‚‹ã‚­ãƒ¼:", localStorage.getItem('x_consumer_key'));

            // é€ä¿¡ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ€ãƒŸãƒ¼å‡¦ç†ï¼ˆå®Ÿéš›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯OAuthãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¿…è¦ã§ã™ï¼‰
            status.innerText = 'é€ä¿¡æº–å‚™å®Œäº†ï¼ˆOAuthç½²åã®æ§‹ç¯‰ãŒå¿…è¦ã§ã™ï¼‰';
            
        } catch (e) {
            status.innerText = 'âŒ ã‚¨ãƒ©ãƒ¼: ' + e.message;
        }
    }
</script>

</body>
</html>
